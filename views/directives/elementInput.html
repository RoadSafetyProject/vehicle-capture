<style>
    .glyphicon.spinning {
        animation: spin 1s infinite linear;
        -webkit-animation: spin2 1s infinite linear;
    }

    @keyframes spin {
        from {
            transform: scale(1) rotate(0deg);
        }
        to {
            transform: scale(1) rotate(360deg);
        }
    }

    @-webkit-keyframes spin2 {
        from {
            -webkit-transform: rotate(0deg);
        }
        to {
            -webkit-transform: rotate(360deg);
        }
    }
</style>
<script type="text/ng-template" id="customTemplate.html">
    <a>
        <img ng-src="http://upload.wikimedia.org/wikipedia/commons/thumb/{{match.model.flag}}" width="16">
        <span ng-bind-html="match.label | uibTypeaheadHighlight:query"></span>
    </a>
</script>
<div ng-if="!relation">
    <div ng-if="(ngProgramStageDataElement.dataElement.valueType == 'TEXT' || ngProgramStageDataElement.dataElement.valueType == 'NUMBER') && !ngProgramStageDataElement.dataElement.optionSetValue"
         class="form-group">
        <input type="text" class="form-control" ng-model="ngModel.value">
    </div>
    <div ng-if="ngProgramStageDataElement.dataElement.optionSetValue" class="form-group">
        <select class="form-control">
            <option ng-repeat="option in ngProgramStageDataElement.dataElement.optionSet.options">{{option.name}}
            </option>
        </select>
    </div>
    <div ng-if="ngProgramStageDataElement.dataElement.valueType == 'DATE'" class="input-group">
        <input type="text" class="form-control" uib-datepicker-popup="{{format}}" ng-model="ngModel.value"
               is-open="popup1.opened" datepicker-options="dateOptions" ng-required="true" close-text="Close"
               alt-input-formats="altInputFormats"/>
          <span class="input-group-btn">
            <button type="button" class="btn btn-default" ng-click="open1()"><i
                    class="glyphicon glyphicon-calendar"></i></button>
          </span>
    </div>
</div>
<div ng-if="relation">

    <div class="input-group">
        <style>
            .ui-select-focusser.ui-select-offscreen.ng-scope{
                display:none;
            }
        </style>
        <ui-select ng-model="ngModel.value" theme="selectize" ng-disabled="false" title="Choose a country">
            <ui-select-match placeholder="Select...">{{$select.selected | extrapolateDataValue:relation.dataElement.name}}</ui-select-match>
            <ui-select-choices repeat="event in relation.data | filter: $select.search" refresh-delay="0" refresh="relation.searchRelations($select.search)">
                <span ng-bind-html="event | extrapolateDataValue:relation.dataElement.name | highlight: $select.search"></span>
            </ui-select-choices>
        </ui-select>
        <div class="input-group-btn">
            <button type="button" class="btn btn-default dropdown-toggle"
                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span ng-if='relation.feedback.status == "LOADING"' class="glyphicon glyphicon-refresh spinning"></span>
                <span ng-if='relation.feedback.status != "LOADING"'>Actions<span class="caret"></span></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right">
                <li><a></a></li>
            </ul>
        </div>
    </div>
    <div ng-if='relation.feedback.status == "ERROR"' class="alert alert-danger" role="alert">
        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
        {{relation.feedback.message}}
    </div>
    <div ng-if='relation.feedback.status == "SUCCESS"' class="alert alert-success" role="alert">
        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
        {{relation.feedback.message}}
    </div>
</div>
